<div class="row">
  <span class="col-md-11" id="title"><%= @dataset.title %></span>
  <% if can? :update, @dataset %>
    <span class="col-md-1 pull-right">
      <%= link_to edit_dataset_path(@dataset), :class => "btn btn-info btn-sm" do %>
        <span class="glyphicon glyphicon-edit"></span> Edit
      <% end %>
    </span>
  <% end %>
</div>
<div class="container-fluid" id="citation-block">

  <div class="row bg-citation">
    <div id="citation" class="col-md-9" onclick="if (event.target) { selectText(event.target); } else{ selectText(this); }"><%= @dataset.plain_text_citation %></div>
    <div class="col-md-3 text-right" id="citation-download">
      <div class="dropdown">
        <button type="button" id="downloadCitation" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
          <span class="glyphicon glyphicon-list"></span> Citation <span class="caret"></span>
        </button>
        <ul class="dropdown-menu pull-right text-left" role="menu">
          <li>
            <a id="datasetForm:endNoteLink" href="#" onclick='window.location = "/datasets/<%=@dataset.id%>/download_endNote_XML"'>
              EndNote XML
            </a>
          </li>
          <li>
            <a id="datasetForm:risLink" href="#" onclick='window.location = "/datasets/<%=@dataset.id%>/download_RIS"'>
              RIS Format
            </a>
          </li>
          <li>
            <a id="datasetForm:BibTeXLink" href="#" onclick='window.location = "/datasets/<%=@dataset.id%>/download_BibTeX"'>
              BibTeX Format
            </a>
          </li>
          <li>
            <a id="datasetForm:plainTextCitationLink" href="#" onclick='window.location = "/datasets/<%=@dataset.id%>/download_plaintext_citation"'>
              Plain Text
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row bg-muted">
    <span id="citation-standards" class="col-md-9 text-muted small">If you use these data, please add this citation to your scholarly resources. </span>
      <span class="col-md-3 pull-right text-right">
        <!--<span class="label label-primary">Downloads <span class="badge">42</span></span>-->
      </span>
  </div>
</div>

<div class="container-fluid">
  <span class="metadata-label">Dataset Description: </span>
  <%= @dataset.description.empty? ? "[data description not provided]" : @dataset.description %>
</div>

<div class="panel-group" id="rights" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="rightsHeading">
      <h4 class="panel-title">
        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#license" href="#collapseRights" aria-expanded="false" aria-controls="collapseRights">
          License
        </a>
      </h4>
    </div>
    <div id="collapseRights" class="panel-collapse collapse" role="tabpanel" aria-labelledby="rightsHeading">
      <div class="panel-body">
        <%= @dataset.license.empty? ? "[license information not provided]" : @dataset.license %>
      </div>
    </div>
  </div>
</div>

<div class="panel-group" id="files" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingOne">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#files" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Files
        </a>
      </h4>
    </div>
    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
      <div class="panel-body">
        <form role="form">
          <div class="form-group" id="select-files-form-group">
            <table class="table table-striped">
              <tbody>
              <tr>
                <td>
                  <div class="row">
            <span class="col-md-3">
              <button class="btn btn-block btn-primary" type="submit">
                <span class="glyphicon glyphicon-download"></span> Zip and Download Selected
                (<span id="checkFileSelectedCount"></span>)
              </button>
            </span>
                  </div>
                  <div class="row">
                    <span class=" checkbox col-md-3"><label><input type="checkbox" class="checkFileGroup" id="checkAllFiles" value="checkAllFiles">Select
                      all (<%= @dataset.datafiles.count %>) </label></span>
                  </div>
                </td>
              </tr>

              <% @binaries.each do |binary| %>
                <tr>
                  <td>
                    <a href="<%= binary.datafile %>"><%= binary.datafile.file.filename %></a><br/>
                    <br/>
                    <a href="/binaries/<%= binary.id %>/download">download</a>
                  </td>
                </tr>
              <% end %>

              <% @dataset.datafiles.each do |datafile| %>
                <% if datafile.master_bytestream && !datafile.master_bytestream.nil? %>

                  <% binary = datafile.master_bytestream %>
                  <tr>
                    <td>
                      <div class="row checkbox">

          <span class="col-md-4"><label><input type="checkbox" class="checkFile checkFileGroup" name="selected_files[]" value="<%= binary.id %>"><%= binary.filename %>
          </label></span>
                        <span class="col-md-4"><%= datafile.description %></span>
                        <span class="col-md-2"><%= binary.media_type %></span>
                        <span class="col-md-1"><%= number_to_human_size(binary.byte_size) %></span>
                      <span class="col-md-1"><a href="#" onclick='window.location = "/datasets/<%=@dataset.id%>/stream_file/<%= binary.id %>"' class="btn btn-block btn-primary btn-sm" role="button">
                        <span class="glyphicon glyphicon-download"></span> File
                      </a></span>
                      </div>
                    </td>
                  </tr>
                <% end %>

              <% end %>
              </tbody>
            </table>

          </div>
          <!-- end select-files-form-group -->
        </form>
      </div>
    </div>
  </div>
</div>
<div class="container-fluid">
  <p>Depositor:  <%= @dataset.depositor_name %>, <%= @dataset.depositor_email %></p>
</div>