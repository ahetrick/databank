.modal.fade.modal-lg(id="api_modal" role="dialog" )
  .modal-content
    .modal-header
      %a(href="#" class="close" data-dismiss="modal")
        &times;
      %h3 Illinois Data Bank File Upload API

    .modal-body

      %h3 API Overview
      %ul
        %li This API is for uploading files to datasets, up to a total of 2TB per PI per year.
        %li The API for uploading a file to a dataset requires a token, which can be requested here.
        %li A token expires in 3 days, but a new one can be requested here.
        %li Anyone can use this token to upload a file to this dataset, so keep it secure.
        %li This API can only be used on a draft datasets - before it is published or scheduled for publication.
        %li
          The basic URL pattern is
          = %Q[#{IDB_CONFIG[:root_url_text]}/api/dataset/[dataset key]/datafile]
        %li The request method is POST.
        %li The authorization token must be sent in a header.
        %li If using cURL, the -o option must be used to send response output to a file to see the progress meter.
      .current-token
        -if @token
          %strong Current HTTP Authentication Token:
          = @token.identifier
          %br
          %strong Expires:
          = @token.expires.iso8601
      %strong Dataset Key:
      =@dataset.key

      %h3 Example cURL command:

      -if @token
        %pre
          %code
            = simple_format(%Q[curl -F "binary=@/path/to/my_datafile.csv" \\ \n  -H "Authorization: Token token=#{@token.identifier}" \\ \n  -H "Transfer-Encoding: chunked" \\ \n  -X POST #{IDB_CONFIG[:root_url_text]}/api/dataset/#{@dataset.key}/datafile \\ \n  -o /path/to/output.txt])
      -else
        %pre
          %code
            = simple_format(%Q[curl -F "binary=@/path/to/my_datafile.csv" \\ \n  -H "Authorization: Token token=authentication_token" \\ \n  -H "Transfer-Encoding: chunked" \\ \n  -X POST #{IDB_CONFIG[:root_url_text]}/api/dataset/dataset_key/datafile \\ \n  -o /path/to/output.txt])

      %button(type="button" onclick="getToken()" class="btn btn-primary" )
        Get New Token

    .modal-footer
      .control-group
        .controls
          %button(type="button" class="btn btn-danger" data-dismiss="modal")
            %span(class="glyphicon glyphicon-remove" )
            Cancel
