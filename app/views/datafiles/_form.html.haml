-if @dataset
  %br
  %button(type="button" class="btn btn-primary"  onclick='window.location = "/datasets/#{@dataset.key}"' )
    %span(class="glyphicon glyphicon-arrow-left" )
    Back
  %h3
    File For
    =link_to "#{@dataset.title}", dataset_path(@dataset.key)
  = @dataset.plain_text_citation
  %br

  %hr

-if @datafile

  = form_for @datafile do |f|
    - if @datafile.errors.any?
    #error_explanation
      %h2= "#{pluralize(@datafile.errors.count, "error")} prohibited this datafile from being saved:"
      %ul
        - @datafile.errors.full_messages.each do |msg|
          %li= msg

  .field
    = f.label :binary_name
    = f.text_field :binary_name
  .field
    = f.label :binary_size
    = f.text_field :binary_size
  .field
    = f.label :storage_root
    = f.check_box :storage_root
  .field
    = f.label :storage_key
    = f.text_field :storage_key
  .field
    =f.label :peek_type
    =f.text_field :peek_type
  .field
    =f.label :peek_text
    =f.text_area :peek_text

  .actions
    = f.submit 'Save'


  .row
    .col-md-2.col-md-offset-8
      %a.btn.btn-primary.btn-block.idb(href="#{IDB_CONFIG[:root_url_text]}/datafiles/#{@datafile.web_id}/download")
        %span(class="glyphicon glyphicon-download" )
        Download
    -if @dataset.publication_state == PublicationState::DRAFT
    .col-md-2
      =link_to datafile_path(@datafile.web_id), :method => :delete, :data => { :confirm => 'Are you sure?' }, :class => "btn btn-danger btn-block idb" do
        %span(class="glyphicon glyphicon-trash" )
        Delete